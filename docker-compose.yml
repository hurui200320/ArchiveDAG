version: "3.3"
services:
  postgres:
    image: postgres
    user: 1000:100
    ports:
      - "5432:5432"
    restart: always
    environment:
      POSTGRES_PASSWORD: password
      POSTGRES_DB: archive_dag
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - /home/skyblond/ArchiveDAG/data/postgresql:/var/lib/postgresql/data
      - /etc/passwd:/etc/passwd:ro
  # No need for redis for now
  #redis:
  #  image: redis
  #  ports:
  #    - "6379:6379"
  #  restart: always
  #  volumes:
  #    - /home/skyblond/ArchiveDAG/data/redis:/data
  etcd:
    image: bitnami/etcd
    environment:
      - ALLOW_NONE_AUTHENTICATION=yes
      - ETCD_ADVERTISE_CLIENT_URLS=http://etcd:2379
    ports:
      - "2379:2379"
      - "2380:2380"
    restart: always
    volumes:
      - /home/skyblond/ArchiveDAG/data/etcd:/bitnami/etcd
